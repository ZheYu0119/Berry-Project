ggplot(unfood,mapping=aes(x=Year,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Year")+
coord_cartesian(ylim = c(0,2))+
facet_wrap(.~State,scales = "free_x")
ggplot(unfood,mapping=aes(x=Year,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Year")+
coord_cartesian(ylim = c(0,2))+
facet_wrap(~State,scales = "free_x")
unfood$Year <- as.character(unfood$Year)
ggplot(unfood,mapping=aes(x=Year,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Year")+
coord_cartesian(ylim = c(0,2))+
facet_wrap(.~State,scales = "free")
print(df.zeros)
# find number of zeros in each crime
df3 <- df[, -1]
df.zeros <- apply(df3, 2, function(x) {sum(x == 0)})
print(df.zeros)
# find the upper inner fence value for each crime
maxval <- apply(df3, 2, function(x) { (IQR(x) * 1.5) + quantile(x, probs = 0.75) })
print(maxval)
# find number of outliers in each crime
df4 <- data.frame(matrix(ncol = 15, nrow = 0))
maxvals <- NULL
num.outliers <- NULL
num.zeros <- NULL
for (i in 2:15) {
dfsub <- df[which(df[, i] > maxval[[i - 1]]), ]
print(paste0(colnames(df)[i], ": ", nrow(dfsub)))
maxvals <- c(maxvals, maxval[[i - 1]])
num.outliers <- c(num.outliers, nrow(dfsub))
num.zeros <- c(num.zeros, df.zeros[[i - 1]])
df4 <- rbind(df4, dfsub)
print(nrow(df4))
}
# create table
outliers.table <- data.frame(cbind(colnames(df)[2:15], maxvals, num.outliers, num.zeros))
colnames(outliers.table) <- c("Crime type", "Upper inner fence value", "Number outliers", "Number zeros")
print(outliers.table)
write.csv(outliers.table, file = "Output/outliers-table-full.csv", row.names = FALSE)
# find number of outliers in each crime
unfood4 <- data.frame(matrix(ncol = 7, nrow = 0))
maxvals <- NULL
num.outliers <- NULL
num.zeros <- NULL
for (i in 2:7) {
unfoodsub <- unfood[which(df[, i] > maxval[[i - 1]]), ]
print(paste0(colnames(unfood)[i], ": ", nrow(unfoodsub)))
maxvals <- c(maxvals, maxval[[i - 1]])
num.outliers <- c(num.outliers, nrow(unfoodsub))
num.zeros <- c(num.zeros, df.zeros[[i - 1]])
unfood4 <- rbind(unfood4, unfoodsub)
print(nrow(unfood4))
}
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot(reorder(class,Chemical,FUN = median()))+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot(reorder(class,Chemical,FUN = media))+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot(reorder(class,Chemical,FUN = mediaN))+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
geom_boxplot(reorder(class,Chemical,FUN = median)+
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot(reorder(class,Chemical,FUN = median))+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot(reorder(class,Chemical,FUN = median))+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
unfood$Chemicaltype <- ifelse(unfood$Chemical=="(NITROGEN)"|unfood$Chemical=="(PHOSPHATE)"|unfood$Chemical=="(POTASH)","FERTILIAZER","AGENTIA")
unfood_2 <- filter(unfood,Chemical=="(NITROGEN)"|Chemical=="(PHOSPHATE)"|Chemical=="(POTASH)")
ctype1 <- ggplot(unfood_2,mapping=aes(x=Chemical,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Fertilizer")
unfood_3 <- filter(unfood,Chemical=="FUNGICIDE"|Chemical=="HERBICIDE"|Chemical=="INSECTICIDE"|Chemical=="OTHER")
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot(reorder(class,Chemical,FUN = median))+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value,reorder(class,Chemical,FUN = median)))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
unfood$Chemicaltype <- ifelse(unfood$Chemical=="(NITROGEN)"|unfood$Chemical=="(PHOSPHATE)"|unfood$Chemical=="(POTASH)","FERTILIAZER","AGENTIA")
unfood_2 <- filter(unfood,Chemical=="(NITROGEN)"|Chemical=="(PHOSPHATE)"|Chemical=="(POTASH)")
ctype1 <- ggplot(unfood_2,mapping=aes(x=Chemical,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Fertilizer")
unfood_3 <- filter(unfood,Chemical=="FUNGICIDE"|Chemical=="HERBICIDE"|Chemical=="INSECTICIDE"|Chemical=="OTHER")
ctype2 <- ggplot(unfood_3,mapping=aes(x=reorder(class,Chemical,FUN = median),y=Value,reorder(class,Chemical,FUN = median)))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
ctype2 <- ggplot(unfood_3,mapping=aes(x=reorder(class,Chemical,FUN = median),y=Value))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
unfood$Chemicaltype <- ifelse(unfood$Chemical=="(NITROGEN)"|unfood$Chemical=="(PHOSPHATE)"|unfood$Chemical=="(POTASH)","FERTILIAZER","AGENTIA")
unfood_2 <- filter(unfood,Chemical=="(NITROGEN)"|Chemical=="(PHOSPHATE)"|Chemical=="(POTASH)")
ctype1 <- ggplot(unfood_2,mapping=aes(x=Chemical,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Fertilizer")
unfood_3 <- filter(unfood,Chemical=="FUNGICIDE"|Chemical=="HERBICIDE"|Chemical=="INSECTICIDE"|Chemical=="OTHER")
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
unfood$Chemicaltype <- ifelse(unfood$Chemical=="(NITROGEN)"|unfood$Chemical=="(PHOSPHATE)"|unfood$Chemical=="(POTASH)","FERTILIAZER","AGENTIA")
unfood_2 <- filter(unfood,Chemical=="(NITROGEN)"|Chemical=="(PHOSPHATE)"|Chemical=="(POTASH)")
ctype1 <- ggplot(unfood_2,mapping=aes(x=Chemical,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Fertilizer")
unfood_3 <- filter(unfood,Chemical=="FUNGICIDE"|Chemical=="HERBICIDE"|Chemical=="INSECTICIDE"|Chemical=="OTHER")
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot(mapping=aes(x=reorder(class,Chemical,FUN = median),y=Value))+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
unfood$Chemicaltype <- ifelse(unfood$Chemical=="(NITROGEN)"|unfood$Chemical=="(PHOSPHATE)"|unfood$Chemical=="(POTASH)","FERTILIAZER","AGENTIA")
unfood_2 <- filter(unfood,Chemical=="(NITROGEN)"|Chemical=="(PHOSPHATE)"|Chemical=="(POTASH)")
ctype1 <- ggplot(unfood_2,mapping=aes(x=Chemical,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "Fertilizer")
unfood_3 <- filter(unfood,Chemical=="FUNGICIDE"|Chemical=="HERBICIDE"|Chemical=="INSECTICIDE"|Chemical=="OTHER")
ctype2 <- ggplot(unfood_3,mapping=aes(x=Chemical,y=Value))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
coord_cartesian(ylim = c(0,2))+
labs(x = "Agentia")
grid.arrange(ctype1,ctype2,nrow=1)
ggplot(unfood,mapping=aes(x=State,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold"),title="state with value") +
labs(x = "State")+
coord_cartesian(ylim = c(0,2))+
facet_wrap(.~Year,scales = "free")
ggplot(unfood,mapping=aes(x=State,y=Value))+geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1),
axis.text = element_text(size = 10),
axis.title = element_text(size = 13, face = "bold")) +
labs(x = "State")+
coord_cartesian(ylim = c(0,2))+
facet_wrap(.~Year,scales = "free")
kable(head(rberry, n=10)) %>% kable_styling(font_size=12)
kable(head(unfood_1, n=10)) %>% kable_styling(font_size=12)
kable(head(unfood, n=10)) %>% kable_styling(font_size=12)
unique(unfood$Materials)
unfood.pca <- princomp(unfood,cor = T)
library(knitr)
library(kableExtra)
library(png)
library(tidyverse)
library(grid)
library(gridExtra)
opts_chunk$set(echo = FALSE)
data("USArrests")
kable(USArrests[1:25,]) %>% kable_styling(font_size = 12)
kable(map_dfr(USArrests, var))
scaled = map_dfr(USArrests, scale)
kable(scaled) %>% kable_styling(font_size=12)
arrests.cov <- cov(scaled)
arrests.eigen <- eigen(arrests.cov)
phi <- arrests.eigen$vectors[,1:2]
t(arrests.eigen$vectors[,1]) %*% arrests.eigen$vectors[,2]
t(arrests.eigen$vectors[,2]) %*% arrests.eigen$vectors[,4]
phi <- -phi
row.names(phi) <- c("Murder", "Assault", "UrbanPop", "Rape")
colnames(phi) <- c("PC1", "PC2")
phi
PC1 <- as.matrix(scaled) %*% phi[,1]
PC2 <- as.matrix(scaled) %*% phi[,2]
PC <- data.frame(State = row.names(USArrests), PC1, PC2)
head(PC)
ggplot(PC, aes(PC1, PC2)) +
modelr::geom_ref_line(h = 0) +
modelr::geom_ref_line(v = 0) +
geom_text(aes(label = State), size = 3) +
xlab("First Principal Component") +
ylab("Second Principal Component") +
ggtitle("First Two Principal Components of USArrests Data")
PVE <- arrests.eigen$values / sum(arrests.eigen$values)
round(PVE, 2)
# PVE (aka scree) plot
PVEplot <- qplot(c(1:4), PVE) +
geom_line() +
xlab("Principal Component") +
ylab("PVE") +
ggtitle("Scree Plot") +
ylim(0, 1)
# Cumulative PVE plot
cumPVE <- qplot(c(1:4), cumsum(PVE)) +
geom_line() +
xlab("Principal Component") +
ylab(NULL) +
ggtitle("Cumulative Scree Plot") +
ylim(0,1)
grid.arrange(PVEplot, cumPVE, ncol = 2)
pca_result <- prcomp(USArrests, scale = TRUE)
names(pca_result)
# means
kable(t(pca_result$center))
##   Murder  Assault UrbanPop     Rape
##    7.788  170.760   65.540   21.232
# standard deviations
kable(t(pca_result$scale))
##    Murder   Assault  UrbanPop      Rape
##  4.355510 83.337661 14.474763  9.366385
View(df3)
f <- unfood_1$FUNGICIDE
View(f)
View(a)
mean(a[1,])
mean(a[1,])
mean(a[1])
print(a[1])
as.numeric(a)
print(a[1][1])
(a[1])[1]
unlist(f)
as.numeric(f)
f <- unlist(f)
f <- as.numeric(f)
f <- unlist(a[1])
mean(f)
sum(g)
sum(f)
for (i in 1:6) {
f <- as.numeric(unfood_1$FUNGICIDE[i])
unfood_1$FUNGICIDE[i] <- sum(f)
}
f <- as.numeric(unlist(unfood_1$FUNGICIDE[i]))
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$FUNGICIDE[i]))
unfood_1$FUNGICIDE[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$j[i]))
unfood_1$j[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$INSECTICIDE[i]))
unfood_1$INSECTICIDE[i] <- sum(f)
}
unfood_1$HERBICIDE[i] <- sum(f)
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$HERBICIDE[i]))
unfood_1$HERBICIDE[i] <- sum(f)
}
unfood_1 <- filter(unfood_1,-j)
unfood_1 <- select(unfood_1,-j)
unfood_1 <- str_replace(unfood_1,"NULL",0)
unfood_1$NITROGEN <- str_replace(unfood_1$NITROGEN,"NULL",NA)
kable(head(unfood_1, n=10)) %>% kable_styling(font_size=12)
df <- unfood_1[,-c(1,2)]
View(df)
pca <- prcomp(df,center = T,scale. = T)
df <- as.numeric(df)
df <- df[,c(1,2,4)]
df <- as.numeric(df)
df$FUNGICIDE <- as.numeric(df$FUNGICIDE)
pca <- prcomp(df,center = T,scale. = T)
df$INSECTICIDE <- as.numeric(df$INSECTICIDE)
df$HERBICIDE <- as.numeric(df$HERBICIDE)
pca <- prcomp(df,center = T,scale. = T)
print(pca)
print(pca2.1)
pca2.1 <- pca
pca2.1$rotation <- -pca2.1$rotation
pca2.1$x <- -pca2.1$x
print(pca2.1)
summary(pca2.1)
plot(pca, type="lines")
biplot(pca2.1, scale = 0)
pc12 <- data.frame(pca2.1$rotation[, 1:2])
pc12$type <- rownames(pc12)
pt1 <- ggplot(pc12, aes(x = PC1, y = PC2))
pt1 <- pt1 + geom_point(size = 3) +
geom_text(aes(label = type), vjust = 1) +
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 13, face = "bold"))
print(pt1)
unfood_1[is.null(unfood_1)] <- "0"
View(unfood_1)
unfood_1[is.null(unfood_1)] <- " "
unfood_1$OTHER
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$OTHER[i]))
unfood_1$OTHER[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(NITROGEN)`[i]))
unfood_1$`(NITROGEN)`[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(PHOSPHATE)`[i]))
unfood_1$`(PHOSPHATE)`[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(POTASH)`[i]))
unfood_1$`(POTASH)`[i] <- sum(f)
}
unfood_1$FUNGICIDE <- as.numeric(unfood_1$FUNGICIDE)
unfood_1$INSECTICIDE <- as.numeric(unfood_1$INSECTICIDE)
unfood_1$HERBICIDE <- as.numeric(unfood_1$HERBICIDE)
unfood_1$OTHER <- as.numeric(unfood_1$OTHER)
unfood_1$`(NITROGEN)` <- as.numeric(unfood_1$`(NITROGEN)`)
unfood_1$`(PHOSPHATE)` <- as.numeric(unfood_1$`(PHOSPHATE)`)
unfood_1$`(POTASH)` <- as.numeric(unfood_1$`(POTASH)`)
pca <- prcomp(df,center = T,scale. = T)
print(pca)
pca2.1 <- pca
pca2.1$rotation <- -pca2.1$rotation
pca2.1$x <- -pca2.1$x
print(pca2.1)
summary(pca2.1)
plot(pca, type="lines")
biplot(pca2.1, scale = 0)
pca <- prcomp(unfood_1,center = T,scale. = T)
unfood_1$FUNGICIDE <- as.numeric(unfood_1$FUNGICIDE)
unfood_1$INSECTICIDE <- as.numeric(unfood_1$INSECTICIDE)
unfood_1$HERBICIDE <- as.numeric(unfood_1$HERBICIDE)
unfood_1$OTHER <- as.numeric(unfood_1$OTHER)
unfood_1$`(NITROGEN)` <- as.numeric(unfood_1$`(NITROGEN)`)
unfood_1$`(PHOSPHATE)` <- as.numeric(unfood_1$`(PHOSPHATE)`)
unfood_1$`(POTASH)` <- as.numeric(unfood_1$`(POTASH)`)
pca <- prcomp(unfood_1,center = T,scale. = T)
df <- unfood_1[,-c(1,2)]
pca <- prcomp(df,center = T,scale. = T)
print(pca)
pca2.1 <- pca
pca2.1$rotation <- -pca2.1$rotation
pca2.1$x <- -pca2.1$x
print(pca2.1)
plot(pca, type="lines")
pc12 <- data.frame(pca2.1$rotation[, 1:2])
pc12$type <- rownames(pc12)
pt1 <- ggplot(pc12, aes(x = PC1, y = PC2))
pt1 <- pt1 + geom_point(size = 3) +
geom_text(aes(label = type), vjust = 1) +
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 13, face = "bold"))
print(pt1)
plot(pca, type="lines")
biplot(pca2.1, scale = 0)
print(pt1)
unfood_1 <- unfood %>%  select(Year, State, Chemical, Value)
unfood_1$Value <- as.numeric(unfood_1$Value)
unfood_1 %<>% pivot_wider(names_from = Chemical, values_from = Value)
a <- unfood_1$FUNGICIDE
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$INSECTICIDE[i]))
unfood_1$INSECTICIDE[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$FUNGICIDE[i]))
unfood_1$FUNGICIDE[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$HERBICIDE[i]))
unfood_1$HERBICIDE[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$OTHER[i]))
unfood_1$OTHER[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(NITROGEN)`[i]))
unfood_1$`(NITROGEN)`[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(PHOSPHATE)`[i]))
unfood_1$`(PHOSPHATE)`[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(POTASH)`[i]))
unfood_1$`(POTASH)`[i] <- sum(f)
}
kable(head(rberry, n=10)) %>% kable_styling(font_size=12)
kable(head(unfood_1, n=10)) %>% kable_styling(font_size=12)
unfood_1$FUNGICIDE <- as.numeric(unfood_1$FUNGICIDE)
unfood_1$INSECTICIDE <- as.numeric(unfood_1$INSECTICIDE)
unfood_1$HERBICIDE <- as.numeric(unfood_1$HERBICIDE)
unfood_1$OTHER <- as.numeric(unfood_1$OTHER)
unfood_1$`(NITROGEN)` <- as.numeric(unfood_1$`(NITROGEN)`)
unfood_1$`(PHOSPHATE)` <- as.numeric(unfood_1$`(PHOSPHATE)`)
unfood_1$`(POTASH)` <- as.numeric(unfood_1$`(POTASH)`)
df <- unfood_1[,-c(1,2)]
pca <- prcomp(df,center = T,scale. = T)
print(pca)
pca2.1 <- pca
pca2.1$rotation <- -pca2.1$rotation
pca2.1$x <- -pca2.1$x
print(pca2.1)
summary(pca2.1)
plot(pca, type="lines")
biplot(pca2.1, scale = 0)
pc12 <- data.frame(pca2.1$rotation[, 1:2])
pc12$type <- rownames(pc12)
pt1 <- ggplot(pc12, aes(x = PC1, y = PC2))
pt1 <- pt1 + geom_point(size = 3) +
geom_text(aes(label = type), vjust = 1) +
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 13, face = "bold"))
print(pt1)
unfood_1 <- unfood %>%  select(Year, State, Chemical, Value)
unfood_1$Value <- as.numeric(unfood_1$Value)
unfood_1 %<>% pivot_wider(names_from = Chemical, values_from = Value)
a <- unfood_1$FUNGICIDE
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$INSECTICIDE[i]))
unfood_1$INSECTICIDE[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$FUNGICIDE[i]))
unfood_1$FUNGICIDE[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$HERBICIDE[i]))
unfood_1$HERBICIDE[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$OTHER[i]))
unfood_1$OTHER[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(NITROGEN)`[i]))
unfood_1$`(NITROGEN)`[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(PHOSPHATE)`[i]))
unfood_1$`(PHOSPHATE)`[i] <- sum(f)
}
for (i in 1:6) {
f <- as.numeric(unlist(unfood_1$`(POTASH)`[i]))
unfood_1$`(POTASH)`[i] <- sum(f)
}
kable(head(rberry, n=10)) %>% kable_styling(font_size=12)
kable(head(unfood_1, n=10)) %>% kable_styling(font_size=12)
